<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A√±adir Propiedad - Portal Inmobiliario</title>
<link rel="stylesheet" href="styles.css">
<style>
body { background:#FFF9E5; font-family: Arial, sans-serif; padding:20px; }
h1 { text-align:center; color:#7CC242; }
.formulario-multistep { background:white; padding:20px; border-radius:10px; max-width:600px; margin:20px auto; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.formulario-multistep input, .formulario-multistep select, .formulario-multistep button { width:100%; margin-bottom:10px; padding:8px; border-radius:5px; border:1px solid #ccc; box-sizing:border-box; }
.formulario-multistep button { background:#A6CF3E; color:white; border:none; cursor:pointer; font-size:1em; transition: background 0.3s; }
.formulario-multistep button:hover { background:#7CC242; }
.mensaje { text-align:center; font-weight:bold; margin-top:10px; }
.informacion-util { background:white; padding:15px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-top:20px; max-width:600px; margin-left:auto; margin-right:auto;}
.informacion-util h3 { color:#7CC242; margin-bottom:10px; }
.informacion-util ul { padding-left:20px; line-height:1.6; }
.informacion-util a { color:#A6CF3E; text-decoration:none; }
.informacion-util a:hover { text-decoration:underline; }
</style>
</head>
<body>

<h1>A√±adir Propiedad üè°</h1>

<form id="formAgregarPropiedad" class="formulario-multistep" enctype="multipart/form-data">

  <!-- Paso 1 -->
  <div class="paso" id="paso1">
    <h2>Datos b√°sicos</h2>
    <input type="text" name="titulo" placeholder="T√≠tulo" required>
    <input type="text" name="direccion" placeholder="Direcci√≥n completa" required>
    <button type="button" id="siguiente1">Siguiente ‚Üí</button>
  </div>

  <!-- Paso 2 -->
  <div class="paso" id="paso2" style="display:none;">
    <h2>Detalles</h2>
    <input type="number" name="precio" placeholder="Precio (‚Ç¨)" required>
    <input type="text" name="descripcion" placeholder="Descripci√≥n">
    <button type="button" id="anterior2">‚Üê Anterior</button>
    <button type="button" id="siguiente2">Siguiente ‚Üí</button>
  </div>

  <!-- Paso 3 -->
  <div class="paso" id="paso3" style="display:none;">
    <h2>Fotos</h2>
    <input type="file" name="imagen" accept="image/*" required>
    <button type="button" id="anterior3">‚Üê Anterior</button>
    <button type="submit">A√±adir Propiedad</button>
  </div>

</form>

<p id="mensaje" class="mensaje"></p>

<!-- Informaci√≥n √∫til -->
<div class="informacion-util">
<h3>Informaci√≥n √∫til</h3>
<ul>
<li>üì∑ Ten las fotos a mano para que tu anuncio sea m√°s atractivo.</li>
<li>üéÅ Los dos primeros anuncios son gratuitos.</li>
<li>‚ö†Ô∏è Se aplican cargos para m√°s de dos inmuebles o anuncios duplicados.</li>
<li>üè¢ <a href="vender.html">M√°s informaci√≥n sobre vender tu propiedad ‚Üí</a></li>
<li>üëî <a href="profesionales.html">Ventajas para profesionales ‚Üí</a></li>
</ul>
</div>

<script>
// Navegaci√≥n multistep
let pasoActual = 1;
function mostrarPaso(paso) {
  document.querySelectorAll(".paso").forEach((el, i) => el.style.display = (i+1) === paso ? "block" : "none");
}
document.getElementById("siguiente1").addEventListener("click", ()=> { pasoActual=2; mostrarPaso(pasoActual); });
document.getElementById("siguiente2").addEventListener("click", ()=> { pasoActual=3; mostrarPaso(pasoActual); });
document.getElementById("anterior2").addEventListener("click", ()=> { pasoActual=1; mostrarPaso(pasoActual); });
document.getElementById("anterior3").addEventListener("click", ()=> { pasoActual=2; mostrarPaso(pasoActual); });

// Submit con imagen a Cloudinary
const form = document.getElementById("formAgregarPropiedad");
const mensaje = document.getElementById("mensaje");

form.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const formData = new FormData(form);

  try {
    const res = await fetch("/propiedades", { method:"POST", body:formData });
    const data = await res.json();
    if(res.ok){
      mensaje.textContent = "‚úÖ Propiedad a√±adida con √©xito!";
      form.reset();
      pasoActual=1; mostrarPaso(pasoActual);
    } else {
      mensaje.textContent = "‚ùå Error: "+(data.error||"No se pudo a√±adir");
    }
  } catch(err){
    console.error(err);
    mensaje.textContent = "‚ùå Error al conectar con el servidor.";
  }
});
</script>

</body>
</html>
