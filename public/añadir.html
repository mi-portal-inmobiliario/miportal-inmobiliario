<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A√±adir Propiedad - Portal Inmobiliario</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
    h1, h2 { color: #333; }
    h2 { margin-top: 30px; }

    .informacion-util {
      background: #fffbe6;
      border-left: 5px solid #f1c40f;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .formulario {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      max-width: 700px;
      margin: 0 auto 30px;
    }

    .formulario label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    .formulario input, .formulario select, .formulario textarea, .formulario button {
      width: 100%;
      margin-top: 5px;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    .formulario button {
      background-color: #3498DB;
      color: white;
      border: none;
      cursor: pointer;
      padding: 12px;
      font-size: 1em;
      margin-top: 15px;
      transition: background 0.3s;
    }

    .formulario button:hover {
      background-color: #2980B9;
    }

    .mensaje {
      text-align: center;
      font-weight: bold;
      margin-top: 10px;
    }

    .checkbox-group label {
      font-weight: normal;
      margin-right: 15px;
    }
  </style>
</head>
<body>

  <h1>Portal Inmobiliario üè°</h1>

  <div class="informacion-util">
    <h2>Informaci√≥n √∫til</h2>
    <p>Ten las fotos a mano. Si no las tienes, podr√°s a√±adirlas m√°s tarde. Sin fotos no tendr√°s resultados.</p>
    <p>Puedes publicar gratis pisos, chalets, garajes, parcelas, locales, etc. hasta que lo vendas o alquiles.</p>
    <p>Para mantener nuestra calidad de servicio, cobramos en los casos de anuncios duplicados o propiedades de gran valor.</p>
  </div>

  <div class="formulario">
    <h2>1. Datos b√°sicos</h2>

    <label for="tipo">Tipo de inmueble</label>
    <select id="tipo">
      <option value="">Selecciona</option>
      <option value="piso">Piso</option>
      <option value="casa">Casa</option>
      <option value="atico">√Åtico</option>
      <option value="chalet">Chalet</option>
      <option value="garaje">Garaje</option>
      <option value="local">Local</option>
      <option value="parcela">Parcela</option>
    </select>

    <label for="operacion">Operaci√≥n</label>
    <select id="operacion">
      <option value="">Selecciona</option>
      <option value="venta">Venta</option>
      <option value="alquiler">Alquiler</option>
    </select>

    <label for="titulo">T√≠tulo del anuncio</label>
    <input type="text" id="titulo" placeholder="Ej: Piso luminoso en el centro">

    <label for="descripcion">Descripci√≥n breve</label>
    <textarea id="descripcion" rows="4" placeholder="Descripci√≥n de la propiedad"></textarea>

    <h2>2. Detalles</h2>

    <label for="habitaciones">N√∫mero de habitaciones</label>
    <input type="number" id="habitaciones" min="0">

    <label for="banos">N√∫mero de ba√±os</label>
    <input type="number" id="banos" min="0">

    <label for="superficie">Superficie (m¬≤)</label>
    <input type="number" id="superficie" min="0">

    <label>Caracter√≠sticas</label>
    <div class="checkbox-group">
      <label><input type="checkbox" value="terraza"> Terraza</label>
      <label><input type="checkbox" value="balcon"> Balc√≥n</label>
      <label><input type="checkbox" value="garaje"> Garaje</label>
      <label><input type="checkbox" value="piscina"> Piscina</label>
      <label><input type="checkbox" value="amueblado"> Amueblado</label>
    </div>

    <label for="precio">Precio (‚Ç¨)</label>
    <input type="number" id="precio" min="0">

    <h2>3. Ubicaci√≥n</h2>

    <label for="localidad">Localidad</label>
    <input type="text" id="localidad" placeholder="Ej: Madrid">

    <label for="calle">Nombre de la v√≠a</label>
    <input type="text" id="calle" placeholder="Ej: Calle Mayor">

    <label for="numero">N√∫mero de v√≠a</label>
    <input type="text" id="numero" placeholder="Ej: 15">

    <label><input type="checkbox" id="ocultarCalle"> Ocultar calle y n√∫mero (opcional)</label>

    <h2>4. Fotos</h2>
    <label for="imagen">URL de la imagen principal</label>
    <input type="text" id="imagen" placeholder="https://">

    <button type="button" id="btn-enviar">A√±adir Propiedad</button>
    <p id="mensaje" class="mensaje"></p>
  </div>

  <script>
    document.getElementById('btn-enviar').addEventListener('click', async () => {
      const caracteristicas = Array.from(document.querySelectorAll('.checkbox-group input:checked')).map(cb => cb.value);

      const propiedad = {
        tipo: document.getElementById('tipo').value,
        operacion: document.getElementById('operacion').value,
        titulo: document.getElementById('titulo').value,
        descripcion: document.getElementById('descripcion').value,
        habitaciones: Number(document.getElementById('habitaciones').value),
        banos: Number(document.getElementById('banos').value),
        superficie: Number(document.getElementById('superficie').value),
        caracteristicas: caracteristicas,
        precio: Number(document.getElementById('precio').value),
        localidad: document.getElementById('localidad').value,
        calle: document.getElementById('calle').value,
        numero: document.getElementById('numero').value,
        ocultarCalle: document.getElementById('ocultarCalle').checked,
        imagen: document.getElementById('imagen').value
      };

      try {
        const res = await fetch('https://miportal-inmobiliario-server.onrender.com/propiedades', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(propiedad)
        });

        const data = await res.json();
        if(res.ok) {
          document.getElementById('mensaje').textContent = '‚úÖ Propiedad a√±adida con √©xito!';
          // limpiar formulario
          document.querySelectorAll('.formulario input, .formulario textarea').forEach(el => el.value = '');
          document.querySelectorAll('.checkbox-group input').forEach(el => el.checked = false);
        } else {
          document.getElementById('mensaje').textContent = '‚ùå Error: ' + (data.error || 'No se pudo a√±adir');
        }
      } catch (err) {
        document.getElementById('mensaje').textContent = '‚ùå Error al conectar con el servidor.';
      }
    });
  </script>
</body>
</html>

