<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A√±adir Propiedad - Portal Inmobiliario</title>
<link rel="stylesheet" href="styles.css">
<style>
  /* Ajustes espec√≠ficos de la p√°gina */
  .formulario-container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    margin-top: 120px; /* espacio por banner */
  }
  .formulario-multistep {
    flex: 1 1 400px;
  }
  .informacion-util {
    flex: 1 1 300px;
    max-width: 350px;
  }
  #previsualizacion img {
    width: 100px;
    height: 100px;
    object-fit: cover;
    border-radius: 5px;
  }
</style>
</head>
<body>

<header class="banner">
  <h1>A√±adir Propiedad üè°</h1>
</header>

<div class="formulario-container">
  <!-- Formulario Multistep -->
  <div class="formulario-multistep">

    <div id="barra-progreso" style="background:#eee; border-radius:5px; height:10px; margin-bottom:20px;">
      <div id="progreso" style="height:10px; width:0%; background:#A6CF3E; border-radius:5px;"></div>
    </div>

    <!-- Paso 1 -->
    <div class="paso" id="paso1">
      <h2>Datos b√°sicos</h2>
      <select id="tipo" required>
        <option value="">Selecciona tipo de inmueble</option>
        <option value="Piso">Piso</option>
        <option value="Chalet">Chalet</option>
        <option value="Garaje">Garaje</option>
        <option value="Local">Local</option>
      </select>
      <select id="operacion" required>
        <option value="">Selecciona operaci√≥n</option>
        <option value="Venta">Venta</option>
        <option value="Alquiler">Alquiler</option>
      </select>
      <input type="text" id="titulo" placeholder="T√≠tulo de la propiedad" required>
      <button type="button" id="siguiente1">Siguiente ‚Üí</button>
    </div>

    <!-- Paso 2 -->
    <div class="paso" id="paso2" style="display:none;">
      <h2>Detalles</h2>
      <input type="number" id="precio" placeholder="Precio (‚Ç¨)" required>
      <input type="number" id="habitaciones" placeholder="Habitaciones">
      <input type="number" id="banos" placeholder="Ba√±os">
      <input type="number" id="superficie" placeholder="Superficie (m¬≤)">
      <button type="button" id="anterior2">‚Üê Anterior</button>
      <button type="button" id="siguiente2">Siguiente ‚Üí</button>
    </div>

    <!-- Paso 3 -->
    <div class="paso" id="paso3" style="display:none;">
      <h2>Fotos y ubicaci√≥n</h2>
      <label>Selecciona las im√°genes (puedes elegir varias)</label>
      <input type="file" id="imagenes" multiple accept="image/*">
      <div id="previsualizacion"></div>
      <input type="text" id="localidad" placeholder="Localidad" required>
      <input type="text" id="calle" placeholder="Nombre de la v√≠a" required>
      <input type="text" id="numero" placeholder="N√∫mero" required>
      <label><input type="checkbox" id="ocultarCalle"> Ocultar calle y n√∫mero (opcional)</label>
      <button type="button" id="anterior3">‚Üê Anterior</button>
      <button type="button" id="btn-enviar">A√±adir Propiedad</button>
    </div>

    <p id="mensaje" class="mensaje"></p>
  </div>

  <!-- Informaci√≥n √∫til al lado -->
  <div class="informacion-util">
    <h3>Informaci√≥n √∫til</h3>
    <ul>
      <li>üì∑ <strong>Ten las fotos a mano.</strong> Si no las tienes, podr√°s a√±adirlas m√°s tarde. Sin fotos no tendr√°s resultados.</li>
      <li>üéÅ <strong>Primeros dos anuncios gratuitos.</strong> Puedes publicar gratis pisos, chalets, garajes, parcelas, locales, etc hasta que lo vendas o lo alquiles.</li>
      <li>üè† <strong>Piso compartido:</strong> Puedes publicar hasta 5 habitaciones gratis en piso compartido, no suman en el n√∫mero de anuncios que te regalamos.</li>
      <li>‚ö†Ô∏è <strong>Casos con cargo:</strong> Se aplican cargos para anunciantes con m√°s de dos inmuebles, anuncios duplicados, inmuebles en venta >1.000.000 ‚Ç¨ o alquiler >2.500 ‚Ç¨/mes.</li>
      <li>üè¢ <strong>¬øQuieres vender tu casa r√°pidamente?</strong><br>
          <a href="vender.html" target="_blank">M√°s informaci√≥n y asistencia ‚Üí</a>
      </li>
      <li>üëî <strong>¬øEres profesional inmobiliario?</strong><br>
          <a href="profesionales.html" target="_blank">Conoce nuestras ventajas para profesionales ‚Üí</a>
      </li>
    </ul>
  </div>
</div>

<script>
// Previsualizaci√≥n de im√°genes
const inputImagenes = document.getElementById('imagenes');
const contenedorPrev = document.getElementById('previsualizacion');
inputImagenes.addEventListener('change', () => {
  contenedorPrev.innerHTML = '';
  Array.from(inputImagenes.files).forEach(file => {
    const reader = new FileReader();
    reader.onload = e => {
      const img = document.createElement('img');
      img.src = e.target.result;
      contenedorPrev.appendChild(img);
    };
    reader.readAsDataURL(file);
  });
});

// Navegaci√≥n multistep
let pasoActual = 1;
function actualizarProgreso() {
  document.getElementById('progreso').style.width = (pasoActual/3*100) + '%';
}

document.getElementById('siguiente1').addEventListener('click', ()=>{
  document.getElementById('paso1').style.display='none';
  document.getElementById('paso2').style.display='block';
  pasoActual=2; actualizarProgreso();
});
document.getElementById('siguiente2').addEventListener('click', ()=>{
  document.getElementById('paso2').style.display='none';
  document.getElementById('paso3').style.display='block';
  pasoActual=3; actualizarProgreso();
});
document.getElementById('anterior2').addEventListener('click', ()=>{
  document.getElementById('paso2').style.display='none';
  document.getElementById('paso1').style.display='block';
  pasoActual=1; actualizarProgreso();
});
document.getElementById('anterior3').addEventListener('click', ()=>{
  document.getElementById('paso3').style.display='none';
  document.getElementById('paso2').style.display='block';
  pasoActual=2; actualizarProgreso();
});
actualizarProgreso();

// Bot√≥n enviar
document.getElementById('btn-enviar').addEventListener('click', async () => {
  const propiedad = {
    tipo: document.getElementById('tipo').value,
    operacion: document.getElementById('operacion').value,
    titulo: document.getElementById('titulo').value,
    precio: Number(document.getElementById('precio').value),
    habitaciones: Number(document.getElementById('habitaciones').value),
    banos: Number(document.getElementById('banos').value),
    superficie: Number(document.getElementById('superficie').value),
    localidad: document.getElementById('localidad').value,
    calle: document.getElementById('calle').value,
    numero: document.getElementById('numero').value,
    ocultarCalle: document.getElementById('ocultarCalle').checked
  };
  try {
    const res = await fetch('/propiedades', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(propiedad)
    });
    const data = await res.json();
    if(res.ok){
      document.getElementById('mensaje').textContent = '‚úÖ Propiedad a√±adida con √©xito!';
    } else {
      document.getElementById('mensaje').textContent = '‚ùå Error: ' + (data.error || 'No se pudo a√±adir');
    }
  } catch(err){
    document.getElementById('mensaje').textContent = '‚ùå Error al conectar con el servidor.';
  }
});
</script>

</body>
</html>













